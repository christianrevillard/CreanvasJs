var g=g||{};g.a=g.a||{};window.CreJs=g;g.Creanvas=g.a;(function(){var a=g.n=g.n||{};a.p=function(f,e,k){var c=this;this.t=f;this.u=e;this.W=k||0;this.Da=function(d){return{P:a.qa(c,d.P),q:a.qa(c,d.q),Ma:a.qa(c,d.Ma)}}};Object.defineProperty(a.p.prototype,"x",{get:function(){return this.t},set:function(a){this.t=a}});Object.defineProperty(a.p.prototype,"y",{get:function(){return this.u},set:function(a){this.u=a}});Object.defineProperty(a.p.prototype,"z",{get:function(){return this.W},set:function(a){this.W=a}});a.Za=function(f,e,k,c){f=k-f;e=c-e;c=Math.sqrt(f*
f+e*e);return{P:new a.p(f/c,e/c,0),q:new a.p(-e/c,f/c,0),Ma:new a.p(0,0,0)}};a.qb=function(a,e,k,c,d){a.lineWidth=5;a.strokeStyle=d;a.beginPath();a.moveTo(e,k);a.lineTo(e+100*c.P.t,k+100*c.P.u);a.moveTo(e,k);a.lineTo(e+50*c.q.t,k+50*c.q.u);a.stroke();a.lineWidth=1;a.strokeStyle="#000"};a.pb=function(a,e,k,c,d,l,b){a.lineWidth=5;a.strokeStyle=b;a.beginPath();a.moveTo(e,k);a.lineTo(e+100*d*c.P.t,k+100*d*c.P.u);a.lineTo(e+100*d*c.P.t+100*l*c.q.t,k+100*d*c.P.u+100*l*c.q.u);a.stroke();a.lineWidth=1;a.strokeStyle=
"#000"};a.qa=function(a,e){return a.t*e.t+a.u*e.u};a.ia=function(f,e){return new a.p(f.u*e.W-f.W*e.u,f.W*e.t-f.t*e.W,f.t*e.u-f.u*e.t)};g.Core=g.n;g.n.Vector=g.n.p})();g.a.Na=function(a){function f(){return a.elements.filter(function(a){return a.ca})}function e(a,d,l){var b,e,h,m,f,k;b=l.nb;m=new g.n.p(l.x-a.i,l.y-a.j);f=g.n.ia(m,b.q).z;k=new g.n.p(l.x-d.i,l.y-d.j);l=g.n.ia(k,b.q).z;var r=g.n.ia(m,b.q),q=g.n.ia(k,b.q);e=new g.n.p(a.b.e.x,a.b.e.y);h=new g.n.p(d.b.e.x,d.b.e.y);a.r&&(e.x+=m.x*a.r.x,e.y+=m.y*a.r.y);d.r&&(h.x+=k.x*d.r.x,h.y+=k.y*d.r.y);m=a.ca.wa*d.ca.wa*2*(h.Da(b).q-e.Da(b).q+d.b.G*q.z-a.b.G*r.z)/(1/d.L+1/a.L+q.z*q.z/d.fa()+r.z*r.z/a.fa());a.b.e.x+=
m/a.L*b.q.x;a.b.e.y+=m/a.L*b.q.y;d.b.e.x-=m/d.L*b.q.x;d.b.e.y-=m/d.L*b.q.y;a.b.G+=m*f/a.fa();d.b.G-=m*l/d.fa()}function k(a,d){var e,b,f,h,m,k,p;h=a.Ca();m=d.Ca();e=Math.max(h.left,m.left)-1;b=Math.min(h.right,m.right)+1;f=Math.max(h.top,m.top)-1;h=Math.min(h.bottom,m.bottom)+1;if(!(0>=b-e||0>=h-f)){e=a.f.getImageData(0,0,a.c,a.g);a.f.scale(1/(a.h||1),1/(a.l||1));a.f.rotate(-(a.m||0));a.f.translate(d.i-a.i,d.j-a.j);a.f.rotate(d.m||0);a.f.scale(d.h||1,d.l||1);a.f.globalCompositeOperation="destination-out";
a.f.drawImage(d.S.canvas,0,0,d.c,d.g,-d.w,-d.A,d.c,d.g);a.f.scale(1/(d.h||1),1/(d.l||1));a.f.rotate(-d.m||0);a.f.translate(-d.i+a.i,-d.j+a.j);a.f.rotate(a.m||0);a.f.scale(a.h||1,a.l||1);k=a.f.getImageData(0,0,a.c,a.g);a.f.globalCompositeOperation="source-over";a.f.putImageData(e,0,0);p=[];a.ya.forEach(function(h){90>k.data[h.y*a.c*4+4*h.x+3]&&p.push(h)});if(2>p.length)return null;var r;f=b=0;e=p.length-1;for(h=1;h<p.length;h++)for(m=h+1;m<p.length;m++){r=p[h].x-p[m].x;var q=p[h].y-p[m].y;r=Math.sqrt(r*
r+q*q);r>b&&(b=r,f=h,e=m)}b=a.ea(p[f].x-a.w,p[f].y-a.A);e=a.ea(p[e].x-a.w,p[e].y-a.A);return b.x==e.x&&b.y==e.y?null:{x:Math.round((b.x+e.x)/2),y:Math.round((b.y+e.y)/2),nb:g.n.Za(b.x,b.y,e.x,e.y)}}}this.kb=function(a){var d=f(),l,b,n;l=a.Ba();d=d.filter(function(h){var b;if(h.D===a.D||!(h.b.e.x||h.b.e.y||a.b.e.x||a.b.e.y||h.r||a.r))return!1;b=h.Ba();return Math.sqrt((l.x-b.x)*(l.x-b.x)+(l.y-b.y)*(l.y-b.y))>a.Ea()+h.Ea()?!1:!0});if(0==d.length)return!0;b=null;d.forEach(function(h){b||(b=k(a,h))&&
(n=h)});if(!b)return!0;e(a,n,b);a.k.I("collision",{element:n,Sa:b});n.k.I("collision",{element:a,Sa:b});return!1}};g.a.Oa=function(a){var f,e,k,c,d,l,b,n;c=this;f=a.canvas;b=a.timeScale||1;n=a.meterPerPoint||1;a.xb?(l=Date.now(),this.getTime=function(){return(Date.now()-l)*b}):(d=0,setInterval(function(){d+=10*b},10),this.getTime=function(){return d});this.R=function(h){a.log&&a.log(h)};c.v=f.getContext("2d");c.v.setTransform(1,0,0,1,0,0);c.v.scale(1/n,1/n);e=!0;isDrawing=!1;k=a.refreshTime||50;this.ta=function(a,b){var d=!1;c.elements.filter(function(b){return b.Ra(a)}).sort(function(a,b){return b.U||0-a.U||
0}).forEach(function(c){!d&&c.ab(b.x,b.y)&&(c.k.I(a,b),d=!0)})};this.La=function(a,b){c.elements.forEach(function(c){c.H==b.H&&c.k.I(a,b)})};this.pa=function(a,b){f.addEventListener(a,function(a){setTimeout(function(){if(a.changedTouches)for(var h=0;h<a.changedTouches.length;h++){var d=a.changedTouches[h].identifier,e=c.V(a.changedTouches[h]);e.H=d;c.ta(b,e)}else h=c.V(a),h.H=-1,c.ta(b,h)})})};this.ha=function(a,b){f.addEventListener(a,function(a){setTimeout(function(){if(a.changedTouches)for(var h=
0;h<a.changedTouches.length;h++){var d=a.changedTouches[h].identifier,e=c.V(a.changedTouches[h]);e.H=d;c.La(b,e)}else h=c.V(a),h.H=-1,c.La(b,h)})})};this.k=new g.X.ka;this.pa("click","click");this.pa("mousedown","pointerDown");this.pa("touchstart","pointerDown");this.ha("mousemove","pointerMove");this.ha("touchmove","pointerMove");this.ha("mouseup","pointerUp");this.ha("touchend","pointerUp");this.lb=function(){c.k.I("deactivate");c.elements=[]};this.M=function(){e=!0};this.V=function(a){var b=f.getBoundingClientRect();
c.R("ClientXY: ("+a.clientX+","+a.clientY+")");b={x:Math.round((a.clientX-b.left)*f.width/b.width*n),y:Math.round((a.clientY-b.top)*f.height/b.height*n)};c.R("canvasXY: ("+b.x+","+b.y+")");"click"==a.type&&c.R("Click on ! canvasXY: ("+b.x+","+b.y+")");return b};c.elements=[];this.add=function(){var a=[].slice.call(arguments),b=new g.a.Qa(c,a[0]);1<a.length&&b.ba.apply(b,a.slice(1));c.elements.push(b);return b};c.R("Adding background");this.add({Q:"background",K:{Z:f.width,Y:f.height,Ga:{ra:0,sa:0},
Fa:a.drawBackground||function(b){b.fillStyle=a.backgroundStyle||"#FFF";b.fillRect(0,0,f.width,f.height)}},Aa:{Ha:-Infinity}});setInterval(function(){e&&!isDrawing?(isDrawing=!0,c.elements.sort(function(a,b){return(a.U||0)-(b.U||0)}).forEach(function(a){c.v.translate(a.i,a.j);c.v.rotate(a.m||0);c.v.scale(a.h||1,a.l||1);c.v.drawImage(a.O.canvas,0,0,a.c,a.g,-a.w,-a.A,a.c,a.g);c.v.scale(1/(a.h||1),1/a.l||1);c.v.rotate(-(a.m||0));c.v.translate(-a.i,-a.j)}),isDrawing=!1):c.R("No redraw")},k);this.addElement=
function(){var a=[].slice.call(arguments),b=a[0];a[0]={Q:b.name,K:b.image?{Z:b.image.width,Y:b.image.height,Fa:b.image.draw,Ga:b.image.translate?{ra:b.image.translate.dx,sa:b.image.translate.dy}:null}:null,Aa:b.position?{gb:b.position.x||0,hb:b.position.y||0,Ha:b.position.z||0}:null};return this.add.apply(this,a)};this.redraw=this.M;this.stop=this.lb};g.a.Controller=g.a.Oa;g.a.Qa=function(a,f){this.Q=f.Q;var e=f.K,k=e.Fa,c=f.Aa,d=[].slice.apply(arguments).slice(2),l=[];this.o=a;this.D=g.ja.la();this.c=e.Z;this.g=e.Y;this.i=c.gb||0;this.j=c.hb||0;this.U=c.Ha||0;this.m=c.wb||0;this.h=e.sb||1;this.l=e.tb||1;this.L=1;c=e.Ga||{ra:e.Z/2,sa:e.Y/2};this.w=c.ra;this.A=c.sa;e.ib?(this.K=e.ib,c=this.o.v.canvas,c=c.ownerDocument.createElement("canvas"),this.O=c.getContext("2d"),this.O.putImageData(this.K,0,0)):(c=this.o.v.canvas,c=c.ownerDocument.createElement("canvas"),c.width=
e.Z,c.height=e.Y,this.O=c.getContext("2d"),this.O.beginPath(),this.O.translate(this.w,this.A),k(this.O),this.K=this.O.getImageData(0,0,e.Z,e.Y));var b=this;this.k=new g.X.ka;this.isPointInPath=function(a){a=b.o.V(a);return b.o.vb.isPointInPath(b,k,a)};0<d.length&&g.a.d&&b.ba(d);this.ab=function(a,c){var d=Math.round(a-b.i+b.w),e=Math.round(c-b.j+b.A);return 0<=d&&d<=b.c&&0<=e&&e<=b.g&&0<b.K.data[4*e*b.c+4*d+3]};this.va=function(a){e.rb=b.K;var c=b.o.add(f),k=a?d.filter(function(b){return a.every(function(a){return a!=
b[0]})}):d;c.ba.apply(c,k);return c};this.jb=function(a){(a=g.a.d[a])&&a.Ia&&a.Ia(b)};this.Ra=function(a){return"click"==a||"pointerDown"==a||b.k.$a(a)};this.Ta=function(){b.o.k.removeEventListener({s:b.D});b.O=null};b.o.k.C({eventId:"deactivate",listenerId:b.D,handleEvent:function(){b.Ta()}});this.M=function(){b.o.M()};this.ea=function(a,c){return{x:Math.round(b.i+a*b.h*Math.cos(b.m)-c*b.l*Math.sin(b.m)),y:Math.round(b.j+a*b.h*Math.sin(b.m)+c*b.l*Math.cos(b.m))}};this.Ba=function(){return b.ea(-b.w+
b.c/2,-b.A+b.g/2)};var n=[];n.push({x:-b.w,y:-b.A});n.push({x:-b.w+b.c,y:-b.A});n.push({x:-b.w+b.c,y:-b.A+b.g});n.push({x:-b.w,y:-b.A+b.g});this.Xa=function(){return n.map(function(a){return b.ea(a.x,a.y)})};this.Wa=function(){var a=b.i+""+b.j+""+b.m+""+b.h+""+b.h;if(l.getClientCorners&&l.getClientCorners.key==a)return l.getClientCorners.value;var c=b.Xa();l.getClientCorners={key:a,value:c};return c};this.Ya=function(){var a=b.Wa();return{top:a.reduce(function(a,b){return Math.min(a,b.y)},Infinity),
bottom:a.reduce(function(a,b){return Math.max(a,b.y)},-Infinity),left:a.reduce(function(a,b){return Math.min(a,b.x)},Infinity),right:a.reduce(function(a,b){return Math.max(a,b.x)},-Infinity)}};this.Ca=function(){var a=b.i+""+b.j+""+b.m+""+b.h+""+b.h;if(l.getClientRect&&l.getClientRect.key==a)return l.getClientRect.value;var c=b.Ya();l.getClientRect={key:a,value:c};return c};this.ba=function(){var a=this,b=[].slice.apply(arguments);d=d.concat(b);b.forEach(function(b){a.na(b[0],b[1])})};this.na=function(a,
b){var c=g.a.d[a];c&&c.N(this,b)};Object.defineProperty(b,"name",{get:function(){return this.Q},set:function(a){this.Q=a}});Object.defineProperty(b,"width",{get:function(){return this.c},set:function(a){this.c=a}});Object.defineProperty(b,"height",{get:function(){return this.g},set:function(a){this.g=a}});Object.defineProperty(b,"scaleX",{get:function(){return this.h},set:function(a){this.h=a}});Object.defineProperty(b,"scaleY",{get:function(){return this.l},set:function(a){this.l=a}});Object.defineProperty(b,
"x",{get:function(){return this.i},set:function(a){this.i=a}});Object.defineProperty(b,"y",{get:function(){return this.j},set:function(a){this.j=a}});Object.defineProperty(b,"z",{get:function(){return this.U},set:function(a){this.U=a}});Object.defineProperty(b,"angle",{get:function(){return this.m},set:function(a){this.m=a}});Object.defineProperty(b,"mass",{get:function(){return this.L},set:function(a){this.L=a}});Object.defineProperty(b,"id",{get:function(){return this.D}});Object.defineProperty(b,
"image",{get:function(){return this.K}});Object.defineProperty(b,"events",{get:function(){return this.k}});b.clone=b.va;b.applyDecorator=b.na;b.applyDecorators=b.ba;b.removeDecorator=b.jb};g=g||{};g.a=g.a||{};g.a.d=g.a.d||[];g.a.d.clickable={N:function(a,f){var e=f.onclick;a.fb=function(f){e.call(a,f);a.M()};a.k.C({F:"click",handleEvent:a.fb})}};g=g||{};g.a=g.a||{};g.a.d=g.a.d||[];
g.a.d.collidable={N:function(a,f){var e=[];a.ca={};var k=f.onCollision,c=f.coefficient;a.o.xa=a.o.xa||new g.a.Na(a.o);a.ca.wa=c||0===c?c:1;a.b=a.b||{e:new g.n.p(0,0),$:new g.n.p(0,0),G:0};a.k.C({F:"collision",handleEvent:function(b){k&&k.call(a,b)}});a.ga=this.ga||[];a.ga.push(function(){return a.o.xa.kb(a)});a.fa=function(){return a.L/12*(a.c*a.h*a.c*a.h+a.g*a.l*a.g*a.l)};a.Va=function(){return Math.sqrt(a.c*a.c*a.h*a.h+a.g*a.g*a.l*a.l)/2};a.Ea=function(){var b=a.c+""+a.g+""+a.h+""+a.l;if(e.getRadius&&
e.getRadius.key==b)return e.getRadius.mb;var c=a.Va();e.geRadius={ub:b,mb:c};return c};var d=a.o.v.canvas,c=d.ownerDocument.createElement("canvas"),d=d.ownerDocument.createElement("canvas");c.width=d.width=a.c;c.height=d.height=a.g;a.S=d.getContext("2d");a.S.putImageData(a.K,0,0);a.S.globalCompositeOperation="source-atop";a.S.fillStyle="#000";a.S.fillRect(0,0,a.c,a.g);a.f=c.getContext("2d");a.f.globalCompositeOperation="source-over";a.f.drawImage(a.S.canvas,0,0);c=a.f.getImageData(0,0,a.c,a.g);d=
a.f.createImageData(a.c,a.g);a.ya=[];for(var l=0;l<a.c;l++)for(var b=0;b<a.g;b++)if(!(200>c.data[b*a.c*4+4*l+3])){for(var n=!1,h=-1;2>h;h++)for(var m=-1;2>m;m++)if(0>b+h||0>l+m||b+h>a.g-1||l+h>a.c-1||100>c.data[(b+h)*a.c*4+4*(l+m)+3])n=!0,m=h=2;a.f.putImageData(d,0,0);n&&(a.ya.push({x:l,y:b}),d.data[b*a.c*4+4*l]=0,d.data[b*a.c*4+4*l+1]=0,d.data[b*a.c*4+4*l+2]=0,d.data[b*a.c*4+4*l+3]=255)}a.f.putImageData(d,0,0);a.f.translate(a.w,a.A)}};g=g||{};g.a=g.a||{};g.a.d=g.a.d||[];g.a.d.customTimer={N:function(a,f){setInterval(function(){f.action.call(a)},f.time)}};g=g||{};g.a=g.a||{};g.a.d=g.a.d||[];g.a.d.droppable={N:function(a,f){var e=f.dropZone;a.cb=!0;a.za=e;Object.defineProperty(a,"dropZone",{get:function(){return this.za},set:function(a){this.za=a}})}};g=g||{};g.a=g.a||{};g.a.d=g.a.d||[];g.a.d.dropzone={N:function(a,f){var e=f.availableSpots,k=f.dropX,c=f.dropY;a.da=[];a.k.C({B:"dropzone",F:"drop",handleEvent:function(d){0>=e||(e--,d.J.x=k||a.i,d.J.y=c||a.j,d.J.T=a,a.da.push(d.J),d.J.k.I("dropped",{T:a,J:d.J}),a.k.I("droppedIn",{T:a,J:d.J}),a.M())},s:a.D});a.Ua=function(c){c.T=null;e++;a.da.splice(a.da.indexOf(c),1);a.M()};Object.defineProperty(a,"droppedElements",{get:function(){return this.da}})}};g=g||{};g.a=g.a||{};g.a.d=g.a.d||[];g.a.d.duplicable={N:function(a,f){var e=f.isBlocked,k=f.generatorCount||Infinity,c=!1;a.k.C({B:"duplicable",F:"pointerDown",handleEvent:function(d){0<=d.H&&(c=!0);if(!(c&&0>d.H||e&&e()||0>=k)){k--;var f=a.va(["duplicable"]);f.Q+=" (duplicate)";f.na("movable",{bb:e});f.Ka(d);a.M()}},s:a.D})},Ia:function(a){a.k.removeEventListener({B:"duplicable",s:a.D})}};g.a.d=g.a.d||[];g.a.elementDecorators=g.a.d;g=g||{};g.a=g.a||{};g.a.d=g.a.d||[];
g.a.d.movable={N:function(a,f){var e=!1,k=this.H=null,c=f.bb;a.Ka=function(c){e=!0;a.H=c.H;k={x:c.x,y:c.y};a.T&&(a.T.Ua(a),a.T=null)};a.eb=function(c){e=!1;k=null;a.cb&&a.o.ta("drop",{x:c.x,y:c.y,J:a})};a.k.C({B:"movable",F:"pointerDown",handleEvent:function(d){c&&c()||a.Ka(d)},s:a.D});var d=!1;a.k.C({B:"movable",F:"pointerMove",handleEvent:function(f){!e||c&&c()||(d||(d=!0),a.i+=f.x-k.x,a.j+=f.y-k.y,k={x:f.x,y:f.y},a.M())},s:a.D});a.k.C({B:"movable",F:"pointerUp",handleEvent:function(f){!e||c&&c()||
(a.o.V(f),a.i+=f.x-k.x,a.j+=f.y-k.y,a.eb(f),a.H=null,d=!1,a.M())},s:a.D})}};g=g||{};g.a=g.a||{};g.a.d=g.a.d||[];
g.a.d.moving={type:"moving",N:function(a,f){var e,k,c,d,l,b=f.vx,n=f.vy,h=f.ax,m=f.ay,s=f.rotationSpeed,p,r,q;a.b=a.b||{};a.b.e=new g.n.p(b||0,n||0);a.b.$=new g.n.p(h||0,m||0);a.b.G=s||0;p=a.o.getTime();setInterval(function(){r=a.o.getTime();q=r-p;if(!(1>q)&&(p=r,a.b.e.x+=a.b.$.x*q,a.b.e.y+=a.b.$.y*q,0!=a.b.e.x||0!=a.b.e.y||0!=a.b.G||a.r&&(0!=a.r.x||0!=a.r.y))){e=a.i;k=a.j;c=a.m;d=a.h;l=a.l;a.i+=a.b.e.x*q;a.j+=a.b.e.y*q;a.m+=a.b.G*q;a.r&&(a.h+=a.r.x*q,a.l+=a.r.y*q);var b=!0;a.ga&&a.ga.forEach(function(c){b&&
(c.call(a)||(b=!1))});b||(a.i=e,a.j=k,a.m=c,a.h=d,a.l=l)}},20);Object.defineProperty(a,"moving",{get:function(){return this.b},set:function(a){this.b=a}});Object.defineProperty(a.b,"speed",{get:function(){return this.e},set:function(a){this.e=a}});Object.defineProperty(a.b,"acceleration",{get:function(){return this.$},set:function(a){this.$=a}});Object.defineProperty(a.b,"rotationSpeed",{get:function(){return this.G},set:function(a){this.G=a}});Object.defineProperty(a,"scaleSpeed",{get:function(){return this.r},
set:function(a){this.r=a}})}};(function(){var a=g.X=g.X||{},f;a.ua=function(a){this.F=a;f=g.ja;var k=[];this.I=function(c,d){f.la();var l=k.length;k.forEach(function(b){b.ob=a;setTimeout(function(){b.handleEvent(c);l--;0==l&&d&&d()})})};this.C=function(a){a.handleEvent=a.handleEvent||a.handleEvent;a.aa=a.aa||a.rank;a.s=a.s||a.listenerId;a.B=a.B||a.eventGroupType;var d=f.la();k.push({oa:d,handleEvent:a.handleEvent,aa:a.aa,s:a.s,B:a.B});k=k.sort(function(a,b){return(a.aa||Infinity)-(b.aa||Infinity)});return d};this.removeEventListener=
function(a){k=k.filter(function(d){return Boolean(a.oa)&&d.oa!=a.oa||Boolean(a.s)&&d.s!=a.s||Boolean(a.B)&&d.B!=a.B})}};g.Creevents=a;a.Event=a.ua})();(function(){var a=g.X=g.X||{};a.ka=function(){var f={},e=[];this.$a=function(a){return void 0!=f[a]};this.C=function(k){var c=k.F||k.eventId;f[c]||(e.push(c),f[c]=new a.ua(c));return f[c].C(k)};this.I=function(a,c,d){f[a]&&(c&&(c.F=a),f[a].I(c,d))};this.removeEventListener=function(a){f[a.F]?f[a.F].removeEventListener(a):e.forEach(function(c){f[c].removeEventListener(a)})};this.addEventListener=this.C};a.EventContainer=a.ka})();(function(){var a=g.ja=g.ja||{};a.la=function(){var f=Date.now().toString(16),f=a.Ja("x",15-f.length)+f;return("xxxxxxxx-xxxx-4xxx-y"+f.slice(0,3)+"-"+f.slice(3)).replace(/[xy]/g,function(a){var f=16*Math.random()|0;return("x"==a?f:f&3|8).toString(16)})};a.Ja=function(f,e){return 0>=e?"":f+a.Ja(f,e-1)}})();(function(){var a=g.Pa=g.Pa||{};a.ma=function(){this.R=function(a){console.log(a)}};g.Crelog=a;a.Logger=a.ma;a.ma.log=a.ma.R})();
